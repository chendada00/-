# 代码重构

重构其实就是对原有代码的优化，包括但不限于对代码逻辑的优化，结构的优化。

####重构原则

- 什么时候重构？

 重构首先根据要自己对系统中代码的理解能力，系统中技术的熟悉程度，以及自己是否有充足的时间，满足以上情况，我们就可以考虑开始重构。

- 为什么重构？

在我们对一个系统进行维护时，难免会发现之前的代码很繁琐，不符合目前的编码规范或者影响到了目前的编码，我们就可以考虑对原有代码进行重构。

- 重构难点

首先就是数据库，对于一些原有代码很多都会跟数据库紧密耦合，所以重构起来就比较艰难，还有就是对于接口的重构，因为接口可能会影响到前端页面的展示，

#### 代码中常见坏味道以及优化

- 方法中参数过长
  - 将其封装为一个对象
- 继承体系中，子类有很多冗余方法
  - 单独提取一个父类供子类继承
- 对于可能为空的对象没有判空
  - 增加判空或者try cache
- 方法中代码过多过长
  - 可以将部分代码封装为工具类
- 重复代码
  - 将重复代码提取为工具类
- 两个类的耦合性过高
  - 分析两个类中耦合的地方，是否可以使用中间类去代替
- 方法中过多的定义临时变量
  - 可以使用静态配置类去替换临时变量

#### 重构的步骤

对于一个系统而言，重构的第一步就是：

- 先了解这个系统的`总体功能`，
- 然后了解系统中所`用到的技术`
- 然后再针对系统中的`单个功能`进行进行深入的了解
  - 这里我觉得首先应该从每个功能的后端接口开始入手，然后一步步深入

当我们对某一个功能的逻辑了解之后就可以开始重构了：

- 根据上面提到的代码中的坏味道以及优化方法进行修改

#### 重构注意事项

- 重构先首先要保证该功能可以正常运行
- 重构时要多使用junit编写测试类进行测试
- 对于修改方法名的重构，要保证引用它的地方同步修改
- 对于数据库和接口相关的重构要特别注意，因为数据库字段不匹配代码并不会立即报错，容易产生隐藏的问题

以上就是我对常用重构知识的总结，对于重构后的代码要多进行测试，保证重构后不会影响之前系统的运行，重构时优先考虑一些小功能的重构，而对于一些架构上的重构我认为尽量避免，因为这些重构会影响很多模块和功能，处理不好可能会影响系统的正常运行。
